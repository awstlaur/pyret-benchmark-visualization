#!/usr/bin/env python

from os import listdir

builds_dir = '/home/awstlaur/pyret-benchmark-visualization/builds/'
report_dir = '/home/awstlaur/pyret-benchmark-visualization/report/'
template_file = '/home/awstlaur/pyret-benchmark-visualization/template.html'

filename_prefix = 'auto-report-'
filename_suffix = '.csv'

current_builds = listdir(builds_dir)
current_reports = listdir(report_dir)

t = open(template_file, 'r')
template = t.read()
t.close()

replace_this = '%%REPLACE%%'

for filename in current_builds:
    number = filename[len(filename_prefix): - len(filename_suffix)]
    report_name = number + '.html'
    if not(report_name in current_reports):
        print 'creating ' + report_name
        new_contents = template.replace(replace_this, filename)
        r = open(report_dir + report_name, 'w')
        r.write(new_contents)
        r.close()


